<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Castle Academy - ××§×“××™×™×ª ×”×˜×™×¨×•×ª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .bounce { animation: bounce 2s infinite; }
        .pulse { animation: pulse 3s infinite; }
        .spin { animation: spin 4s linear infinite; }
        
        .castle-scene {
            position: relative;
            width: 100vw;
            height: 100vh;
            transition: opacity 0.5s;
        }
        
        .hidden { display: none; }
    </style>
</head>
<body class="bg-black">

<!-- Header -->
<div id="header" class="fixed top-0 left-0 right-0 bg-gradient-to-r from-purple-900 to-indigo-900 bg-opacity-95 p-4 shadow-2xl z-50 border-b-4 border-yellow-400">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
        <div class="flex items-center gap-4">
            <button id="backBtn" class="hidden bg-red-500 hover:bg-red-600 text-white p-3 rounded-full transition-all">
                â†
            </button>
            <div class="text-5xl bounce">ğŸ‘‘</div>
            <div>
                <h1 id="headerTitle" class="text-3xl font-bold text-yellow-300" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
                    English Castle Academy
                </h1>
                <p id="headerSubtitle" class="text-lg text-yellow-100">××§×“××™×™×ª ×”×˜×™×¨×•×ª ×œ×× ×’×œ×™×ª</p>
            </div>
        </div>
        <div class="bg-yellow-400 px-6 py-3 rounded-full shadow-lg">
            <div class="flex items-center gap-2">
                <span class="text-2xl">â­</span>
                <span id="score" class="font-bold text-2xl text-purple-800">0</span>
            </div>
        </div>
    </div>
</div>

<!-- Main Container -->
<div id="mainContainer" class="w-full h-screen pt-20"></div>

<!-- Navigation Arrows -->
<button id="leftArrow" class="fixed left-8 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-90 hover:bg-opacity-100 text-purple-800 p-6 rounded-full shadow-2xl transition-all hover:scale-125 z-40 border-4 border-purple-500 pulse">
    <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7" />
    </svg>
</button>

<button id="rightArrow" class="fixed right-8 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-90 hover:bg-opacity-100 text-purple-800 p-6 rounded-full shadow-2xl transition-all hover:scale-125 z-40 border-4 border-purple-500 pulse">
    <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7" />
    </svg>
</button>

<!-- Castle Indicator -->
<div id="indicator" class="fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-white bg-opacity-95 backdrop-blur-sm px-8 py-4 rounded-full shadow-2xl z-40 border-4 border-yellow-400">
    <div id="dots" class="flex items-center gap-3 mb-2"></div>
    <div id="counter" class="text-center font-bold text-purple-800">1 / 6</div>
</div>

<script>
const castles = [
    {
        id: 1,
        name: "Ice Castle",
        nameHe: "×˜×™×¨×ª ×”×§×¨×—",
        bg: "from-blue-200 via-cyan-300 to-blue-400",
        castleColor: "from-cyan-300 to-blue-500",
        roofColor: "bg-blue-600",
        emoji: "â„ï¸",
        decorEmoji: ["â›„", "ğŸ§Š", "â„ï¸", "ğŸŒ¨ï¸"],
        character: "â›·ï¸",
        ground: "from-blue-300 to-cyan-200",
        lessons: [
            { id: 1, title: "Greetings", titleHe: "×‘×¨×›×•×ª", emoji: "ğŸ‘‹" },
            { id: 2, title: "Colors", titleHe: "×¦×‘×¢×™×", emoji: "ğŸ¨" },
            { id: 3, title: "Numbers 1-10", titleHe: "××¡×¤×¨×™× 1-10", emoji: "ğŸ”¢" },
            { id: 4, title: "Family", titleHe: "××©×¤×—×”", emoji: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" },
            { id: 5, title: "Animals", titleHe: "×—×™×•×ª", emoji: "ğŸ¾" },
            { id: 6, title: "Weather", titleHe: "××–×’ ××•×™×¨", emoji: "ğŸŒ¤ï¸" }
        ]
    },
    {
        id: 2,
        name: "Desert Palace",
        nameHe: "××¨××•×Ÿ ×”××“×‘×¨",
        bg: "from-yellow-200 via-orange-300 to-yellow-400",
        castleColor: "from-yellow-400 to-orange-500",
        roofColor: "bg-orange-600",
        emoji: "â˜€ï¸",
        decorEmoji: ["ğŸª", "ğŸŒµ", "ğŸœï¸", "ğŸ¦‚"],
        character: "ğŸ§",
        ground: "from-yellow-400 to-orange-300",
        lessons: [
            { id: 7, title: "Food", titleHe: "××•×›×œ", emoji: "ğŸ”" },
            { id: 8, title: "Fruits", titleHe: "×¤×™×¨×•×ª", emoji: "ğŸ" },
            { id: 9, title: "Vegetables", titleHe: "×™×¨×§×•×ª", emoji: "ğŸ¥•" },
            { id: 10, title: "Drinks", titleHe: "××©×§××•×ª", emoji: "ğŸ¥¤" },
            { id: 11, title: "At Restaurant", titleHe: "×‘××¡×¢×“×”", emoji: "ğŸ½ï¸" },
            { id: 12, title: "Shopping", titleHe: "×§× ×™×•×ª", emoji: "ğŸ›’" }
        ]
    },
    {
        id: 3,
        name: "Forest Kingdom",
        nameHe: "×××œ×›×ª ×”×™×¢×¨",
        bg: "from-green-200 via-emerald-300 to-green-400",
        castleColor: "from-green-400 to-emerald-600",
        roofColor: "bg-green-800",
        emoji: "ğŸŒ³",
        decorEmoji: ["ğŸ¦Œ", "ğŸ„", "ğŸŒ²", "ğŸ¿ï¸"],
        character: "ğŸ§",
        ground: "from-green-500 to-emerald-400",
        lessons: [
            { id: 13, title: "Body Parts", titleHe: "×—×œ×§×™ ×’×•×£", emoji: "ğŸ™‹" },
            { id: 14, title: "Clothes", titleHe: "×‘×’×“×™×", emoji: "ğŸ‘•" },
            { id: 15, title: "Daily Routine", titleHe: "×©×’×¨×ª ×™×•×", emoji: "â°" },
            { id: 16, title: "Time", titleHe: "×©×¢×•×ª", emoji: "ğŸ•" },
            { id: 17, title: "Days & Months", titleHe: "×™××™× ×•×—×•×“×©×™×", emoji: "ğŸ“…" },
            { id: 18, title: "Seasons", titleHe: "×¢×•× ×•×ª ×”×©× ×”", emoji: "ğŸ‚" }
        ]
    },
    {
        id: 4,
        name: "Ocean Castle",
        nameHe: "×˜×™×¨×ª ×”××•×§×™×™× ×•×¡",
        bg: "from-blue-400 via-teal-300 to-cyan-400",
        castleColor: "from-teal-400 to-blue-500",
        roofColor: "bg-blue-700",
        emoji: "ğŸ ",
        decorEmoji: ["ğŸš", "ğŸ¦€", "ğŸ™", "ğŸŒŠ"],
        character: "ğŸ§œâ€â™€ï¸",
        ground: "from-blue-400 to-teal-300",
        lessons: [
            { id: 19, title: "Sports", titleHe: "×¡×¤×•×¨×˜", emoji: "âš½" },
            { id: 20, title: "Hobbies", titleHe: "×ª×—×‘×™×‘×™×", emoji: "ğŸ®" },
            { id: 21, title: "Music", titleHe: "××•×–×™×§×”", emoji: "ğŸµ" },
            { id: 22, title: "Transportation", titleHe: "×ª×—×‘×•×¨×”", emoji: "ğŸš—" },
            { id: 23, title: "Places in City", titleHe: "××§×•××•×ª ×‘×¢×™×¨", emoji: "ğŸ™ï¸" },
            { id: 24, title: "Directions", titleHe: "×›×™×•×•× ×™×", emoji: "ğŸ§­" }
        ]
    },
    {
        id: 5,
        name: "Fire Mountain",
        nameHe: "×”×¨ ×”××©",
        bg: "from-red-300 via-orange-400 to-red-500",
        castleColor: "from-red-500 to-orange-600",
        roofColor: "bg-red-800",
        emoji: "ğŸŒ‹",
        decorEmoji: ["ğŸ”¥", "ğŸ’¥", "ğŸŒ¶ï¸", "ğŸ‰"],
        character: "ğŸ§™â€â™‚ï¸",
        ground: "from-red-400 to-orange-500",
        lessons: [
            { id: 25, title: "Emotions", titleHe: "×¨×’×©×•×ª", emoji: "ğŸ˜Š" },
            { id: 26, title: "Adjectives", titleHe: "×©××•×ª ×ª×•××¨", emoji: "âœ¨" },
            { id: 27, title: "Verbs", titleHe: "×¤×¢×œ×™×", emoji: "ğŸƒ" },
            { id: 28, title: "At School", titleHe: "×‘×‘×™×ª ×¡×¤×¨", emoji: "ğŸ«" },
            { id: 29, title: "Professions", titleHe: "××§×¦×•×¢×•×ª", emoji: "ğŸ‘¨â€âš•ï¸" },
            { id: 30, title: "Question Words", titleHe: "××™×œ×•×ª ×©××œ×”", emoji: "â“" }
        ]
    },
    {
        id: 6,
        name: "Golden Castle",
        nameHe: "×˜×™×¨×ª ×”×–×”×‘",
        bg: "from-yellow-300 via-amber-400 to-yellow-500",
        castleColor: "from-yellow-400 to-amber-500",
        roofColor: "bg-yellow-600",
        emoji: "ğŸ‘‘",
        decorEmoji: ["ğŸ’", "ğŸ‘‘", "ğŸ’°", "â­"],
        character: "ğŸ¦¸",
        ground: "from-yellow-500 to-amber-400",
        lessons: [
            { id: 31, title: "Making Sentences", titleHe: "×‘× ×™×™×ª ××©×¤×˜×™×", emoji: "ğŸ’¬" },
            { id: 32, title: "Conversations", titleHe: "×©×™×—×•×ª", emoji: "ğŸ—£ï¸" },
            { id: 33, title: "Storytelling", titleHe: "×¡×™×¤×•×¨×™×", emoji: "ğŸ“–" },
            { id: 34, title: "Describing Things", titleHe: "×ª×™××•×¨ ×“×‘×¨×™×", emoji: "ğŸ”" },
            { id: 35, title: "Describing People", titleHe: "×ª×™××•×¨ ×× ×©×™×", emoji: "ğŸ‘¤" },
            { id: 36, title: "Free Conversation", titleHe: "×©×™×—×” ×—×•×¤×©×™×ª", emoji: "ğŸ’­" }
        ]
    }
];

let currentCastleIndex = 0;
let selectedCastleId = null;
let completedLessons = {};
let totalScore = 0;

function updateScore(points) {
    totalScore += points;
    document.getElementById('score').textContent = totalScore;
}

function updateNavigation() {
    const leftArrow = document.getElementById('leftArrow');
    const rightArrow = document.getElementById('rightArrow');
    const indicator = document.getElementById('indicator');
    
    if (selectedCastleId) {
        leftArrow.classList.add('hidden');
        rightArrow.classList.add('hidden');
        indicator.classList.add('hidden');
    } else {
        leftArrow.classList.toggle('hidden', currentCastleIndex === 0);
        rightArrow.classList.toggle('hidden', currentCastleIndex === castles.length - 1);
        indicator.classList.remove('hidden');
        
        // Update dots
        const dotsContainer = document.getElementById('dots');
        dotsContainer.innerHTML = '';
        castles.forEach((castle, idx) => {
            const dot = document.createElement('div');
            dot.className = `transition-all rounded-full cursor-pointer ${
                currentCastleIndex === idx ? 'w-6 h-6 bg-purple-600 scale-125' : 'w-4 h-4 bg-gray-300 hover:bg-purple-300'
            }`;
            dot.onclick = () => {
                currentCastleIndex = idx;
                renderCastleSelection();
            };
            dotsContainer.appendChild(dot);
        });
        
        document.getElementById('counter').textContent = `${currentCastleIndex + 1} / ${castles.length}`;
    }
}

function renderCastleScene(castle) {
    const completedCount = castle.lessons.filter(l => completedLessons[l.id]).length;
    const isUnlocked = castle.id === 1 || (castles[castle.id - 2] && 
        castles[castle.id - 2].lessons.every(l => completedLessons[l.id]));
    
    return `
        <div class="castle-scene w-full h-full bg-gradient-to-b ${castle.bg} relative overflow-hidden">
            <!-- Sun/Moon -->
            <div class="absolute top-10 right-10 text-8xl bounce" style="animation-duration: 3s">${castle.emoji}</div>
            
            <!-- Clouds -->
            <div class="absolute top-20 left-10 text-6xl opacity-70 pulse">â˜ï¸</div>
            <div class="absolute top-32 right-1/4 text-5xl opacity-60 pulse" style="animation-delay: 1s">â˜ï¸</div>
            
            <!-- Ground -->
            <div class="absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t ${castle.ground}"></div>
            
            <!-- Castle Structure -->
            <div class="absolute bottom-32 left-1/2 transform -translate-x-1/2 z-10">
                <div class="relative">
                    <!-- Main Body -->
                    <div class="w-96 h-72 bg-gradient-to-b ${castle.castleColor} rounded-t-3xl relative shadow-2xl border-4 border-white border-opacity-30">
                        <!-- Windows -->
                        <div class="absolute top-16 left-16 w-14 h-20 bg-yellow-300 rounded-t-xl shadow-inner pulse" style="animation-duration: 3s"></div>
                        <div class="absolute top-16 right-16 w-14 h-20 bg-yellow-300 rounded-t-xl shadow-inner pulse" style="animation-duration: 3s; animation-delay: 0.5s"></div>
                        <div class="absolute top-32 left-1/2 transform -translate-x-1/2 w-16 h-24 bg-yellow-400 rounded-t-xl shadow-inner pulse" style="animation-duration: 3s; animation-delay: 1s"></div>
                        
                        <!-- Door -->
                        <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 w-24 h-36 bg-gradient-to-b from-amber-800 to-amber-950 rounded-t-3xl border-4 border-amber-900">
                            <div class="absolute top-1/2 right-4 w-3 h-3 bg-yellow-400 rounded-full"></div>
                        </div>
                        
                        ${!isUnlocked ? `
                        <div class="absolute inset-0 bg-black bg-opacity-70 flex items-center justify-center rounded-t-3xl">
                            <div class="text-white text-8xl pulse">ğŸ”’</div>
                        </div>
                        ` : ''}
                    </div>
                    
                    <!-- Left Tower -->
                    <div class="absolute -left-24 bottom-0 w-28 h-96 bg-gradient-to-b ${castle.castleColor} shadow-2xl border-4 border-white border-opacity-30 rounded-t-lg">
                        <div class="absolute -top-10 left-1/2 transform -translate-x-1/2 w-36 h-14 ${castle.roofColor}" style="clip-path: polygon(50% 0%, 0% 100%, 100% 100%)"></div>
                        <div class="absolute top-2 left-1/2 transform -translate-x-1/2 w-4 h-16 bg-yellow-400"></div>
                        <div class="absolute top-0 left-1/2 transform -translate-x-1/2 text-3xl bounce" style="animation-duration: 2s">ğŸš©</div>
                        <div class="absolute top-32 left-1/2 transform -translate-x-1/2 w-10 h-14 bg-yellow-300 rounded-t-lg pulse"></div>
                    </div>
                    
                    <!-- Right Tower -->
                    <div class="absolute -right-24 bottom-0 w-28 h-96 bg-gradient-to-b ${castle.castleColor} shadow-2xl border-4 border-white border-opacity-30 rounded-t-lg">
                        <div class="absolute -top-10 left-1/2 transform -translate-x-1/2 w-36 h-14 ${castle.roofColor}" style="clip-path: polygon(50% 0%, 0% 100%, 100% 100%)"></div>
                        <div class="absolute top-2 left-1/2 transform -translate-x-1/2 w-4 h-16 bg-yellow-400"></div>
                        <div class="absolute top-0 left-1/2 transform -translate-x-1/2 text-3xl bounce" style="animation-duration: 2s; animation-delay: 0.5s">ğŸš©</div>
                        <div class="absolute top-32 left-1/2 transform -translate-x-1/2 w-10 h-14 bg-yellow-300 rounded-t-lg pulse" style="animation-delay: 1s"></div>
                    </div>
                    
                    <!-- Top Tower -->
                    <div class="absolute -top-32 left-1/2 transform -translate-x-1/2 w-24 h-32 bg-gradient-to-b ${castle.castleColor} shadow-2xl border-4 border-white border-opacity-30 rounded-t-lg">
                        <div class="absolute -top-8 left-1/2 transform -translate-x-1/2 w-28 h-12 ${castle.roofColor}" style="clip-path: polygon(50% 0%, 0% 100%, 100% 100%)"></div>
                        <div class="absolute -top-2 left-1/2 transform -translate-x-1/2 text-4xl spin">â­</div>
                    </div>
                </div>
            </div>
            
            <!-- Decorations -->
            <div class="absolute left-8 bottom-32 text-7xl bounce z-20" style="animation-duration: 2s">${castle.decorEmoji[0]}</div>
            <div class="absolute left-1/4 bottom-40 text-6xl bounce z-20" style="animation-duration: 2.5s; animation-delay: 0.3s">${castle.decorEmoji[1]}</div>
            <div class="absolute right-1/4 bottom-36 text-6xl bounce z-20" style="animation-duration: 2.3s; animation-delay: 0.6s">${castle.decorEmoji[2]}</div>
            <div class="absolute right-8 bottom-44 text-7xl bounce z-20" style="animation-duration: 2.8s; animation-delay: 0.9s">${castle.decorEmoji[3]}</div>
            
            <!-- Character -->
            <div class="absolute bottom-48 left-1/2 transform -translate-x-1/2 text-8xl bounce z-30" style="animation-duration: 1.5s">${castle.character}</div>
            
            <!-- Info Card -->
            <div class="absolute top-32 left-1/2 transform -translate-x-1/2 z-40 w-96">
                <div class="bg-white bg-opacity-95 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border-4 border-yellow-400">
                    <div class="text-center mb-4">
                        <h2 class="text-4xl font-bold text-purple-800 mb-2">${castle.name}</h2>
                        <p class="text-2xl text-purple-600">${castle.nameHe}</p>
                    </div>
                    
                    <div class="bg-purple-100 rounded-xl p-4 mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold text-purple-800">Progress:</span>
                            <span class="font-bold text-purple-800">${completedCount}/6 Lessons</span>
                        </div>
                        <div class="w-full bg-purple-300 rounded-full h-4">
                            <div class="bg-gradient-to-r from-green-400 to-green-600 h-4 rounded-full transition-all duration-500" style="width: ${(completedCount / 6) * 100}%"></div>
                        </div>
                    </div>
                    
                    ${isUnlocked ? `
                        <button onclick="enterCastle(${castle.id})" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-4 rounded-2xl text-2xl font-bold shadow-lg transition-all transform hover:scale-105">
                            ğŸ¯ Enter Castle
                        </button>
                    ` : `
                        <div class="text-center text-red-600 font-bold text-lg">
                            ğŸ”’ Complete previous castle to unlock!
                        </div>
                    `}
                </div>
            </div>
        </div>
    `;
}

function renderLessonsView(castle) {
    let lessonsHTML = '';
    castle.lessons.forEach((lesson, index) => {
        const isCompleted = completedLessons[lesson.id];
        const prevLesson = castle.lessons[index - 1];
        const isUnlocked = index === 0 || completedLessons[prevLesson?.id];
        
        lessonsHTML += `
            <div class="relative ${!isUnlocked ? 'opacity-50' : 'cursor-pointer hover:scale-110'} transition-all duration-300" onclick="${isUnlocked ? `openLesson(${lesson.id})` : ''}">
                <div class="bg-gradient-to-br ${isCompleted ? 'from-green-400 to-green-600' : 'from-purple-400 to-blue-500'} rounded-3xl p-6 shadow-2xl border-4 border-white relative">
                    ${!isUnlocked ? `
                    <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-3xl">
                        <div class="text-white text-5xl">ğŸ”’</div>
                    </div>
                    ` : ''}
                    
                    <div class="text-center">
                        <div class="text-6xl mb-3 bounce" style="animation-duration: ${2 + index * 0.2}s">
                            ${isCompleted ? 'âœ…' : lesson.emoji}
                        </div>
                        <h4 class="text-xl font-bold text-white mb-1" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.5)">
                            ${lesson.title}
                        </h4>
                        <p class="text-sm text-white opacity-90">${lesson.titleHe}</p>
                    </div>
                    
                    ${isCompleted ? `
                    <div class="mt-2 bg-white bg-opacity-30 rounded-lg p-1 text-center">
                        <span class="text-white font-bold text-sm">â­ +100</span>
                    </div>
                    ` : ''}
                </div>
            </div>
        `;
    });
    
    return `
        <div class="castle-scene w-full h-full bg-gradient-to-b ${castle.bg} relative overflow-hidden">
            <div class="absolute inset-0 z-10">
                ${renderCastleScene(castle).replace(/<div class="absolute top-32.*?<\/div>\s*<\/div>/s, '')}
            </div>
            
            <div class="absolute inset-0 z-30 flex items-center justify-center pt-20">
                <div class="grid grid-cols-3 gap-6 p-8 max-w-5xl">
                    ${lessonsHTML}
                </div>
            </div>
        </div>
    `;
}

function renderCastleSelection() {
    const container = document.getElementById('mainContainer');
    const castle = castles[currentCastleIndex];
    container.innerHTML = renderCastleScene(castle);
    
    document.getElementById('headerTitle').textContent = 'English Castle Academy';
    document.getElementById('headerSubtitle').textContent = '××§×“××™×™×ª ×”×˜×™×¨×•×ª ×œ×× ×’×œ×™×ª';
    document.getElementById('backBtn').classList.add('hidden');
    
    updateNavigation();
}

function enterCastle(castleId) {
    selectedCastleId = castleId;
    const castle = castles.find(c => c.id === castleId);
    const container = document.getElementById('mainContainer');
    container.innerHTML = renderLessonsView(castle);
    
    document.getElementById('headerTitle').textContent = castle.name;
    document.getElementById('headerSubtitle').textContent = castle.nameHe;
    document.getElementById('backBtn').classList.remove('hidden');
    
    updateNavigation();
}

function openLesson(lessonId) {
    const castle = castles.find(c => c.lessons.some(l => l.id === lessonId));
    const lesson = castle.lessons.find(l => l.id === lessonId);
    
    const modal = `
        <div class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4">
            <div class="bg-white rounded-3xl p-12 max-w-3xl shadow-2xl text-center border-8 border-yellow-400">
                <div class="text-9xl mb-6 bounce">${lesson.emoji}</div>
                <h2 class="text-5xl font-bold text-purple-800 mb-4">${lesson.title}</h2>
                <p class="text-3xl text-purple-600 mb-8">${lesson.titleHe}</p>
                <p class="text-xl text-gray-600 mb-8">
                    ×›××Ÿ ×™×”×™×” ×ª×•×›×Ÿ ×”×©×™×¢×•×¨ ×©×œ×š - ×”×§×œ×˜×•×ª, ×ª×¨×’×™×œ×™×, ××©×—×§×™×...
                </p>
                <div class="flex gap-4 justify-center">
                    <button onclick="completeLesson(${lessonId})" class="bg-green-500 hover:bg-green-600 text-white px-8 py-4 rounded-2xl text-2xl font-bold transition-all transform hover:scale-105">
                        âœ“ Complete Lesson
                    </button>
                    <button onclick="closeLesson()" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-4 rounded-2xl text-2xl font-bold transition-all">
                        â† Back
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', modal);
}

function closeLesson() {
    const modal = document.querySelector('.fixed.inset-0.bg-black');
    if (modal) modal.remove();
}

function completeLesson(lessonId) {
    completedLessons[lessonId] = true;
    updateScore(100);
    closeLesson();
    enterCastle(selectedCastleId);
}

// Event Listeners
document.getElementById('leftArrow').onclick = () => {
    if (currentCastleIndex > 0) {
        currentCastleIndex--;
        renderCastleSelection();
    }
};

document.getElementById('rightArrow').onclick = () => {
    if (currentCastleIndex < castles.length - 1) {
        currentCastleIndex++;
        renderCastleSelection();
    }
};

document.getElementById('backBtn').onclick = () => {
    selectedCastleId = null;
    renderCastleSelection();
};

// Initialize
renderCastleSelection();
</script>

</body>
</html>
